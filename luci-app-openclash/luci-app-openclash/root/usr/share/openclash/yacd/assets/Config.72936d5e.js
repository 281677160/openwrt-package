var J=Object.defineProperty,q=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var P=(e,n,l)=>n in e?J(e,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[n]=l,u=(e,n)=>{for(var l in n||(n={}))O.call(n,l)&&P(e,l,n[l]);if(v)for(var l of v(n))R.call(n,l)&&P(e,l,n[l]);return e},E=(e,n)=>q(e,F(n));var A=(e,n)=>{var l={};for(var s in e)O.call(e,s)&&n.indexOf(s)<0&&(l[s]=e[s]);if(e!=null&&v)for(var s of v(e))n.indexOf(s)<0&&R.call(e,s)&&(l[s]=e[s]);return l};import{R as m,g as K,r as t,k as W,J as Q,j as X}from"./vendor.3cf270b6.js";import{r as Y}from"./logs.8963bea3.js";import{S}from"./Select.9583f722.js";import{s as M,b as Z,d as T,e as $,u as ee,c as j,h as te,g as B,i as ne,o as ae,j as k,k as le,C as se,l as re,B as oe,n as ce,q as ie}from"./index.d6596dd6.js";const{useState:pe,useRef:ue,useEffect:me,useCallback:de}=m;function ge(e){return m.createElement("input",u({className:M.input},e))}function fe(l){var s=l,{value:e}=s,n=A(s,["value"]);const[i,r]=pe(e),d=ue(e);me(()=>{d.current!==e&&r(e),d.current=e},[e]);const g=de(b=>r(b.target.value),[r]);return m.createElement("input",u({className:M.input,value:i,onChange:g},n))}const xe="_root_1tdl3_1",Ee="_section_1tdl3_2",he="_wrapSwitch_1tdl3_26",Ce="_sep_1tdl3_32",ve="_label_1tdl3_45";var c={root:xe,section:Ee,wrapSwitch:he,sep:Ce,label:ve};const be="_fieldset_1ghjp_1",ye="_input_1ghjp_9",Se="_cnt_1ghjp_9";var _={fieldset:be,input:ye,cnt:Se};function ke({OptionComponent:e,optionPropsList:n,selectedIndex:l,onChange:s}){const i=K("visually-hidden",_.input),r=d=>{s(d.target.value)};return m.createElement("fieldset",{className:_.fieldset},n.map((d,g)=>m.createElement("label",{key:g},m.createElement("input",{type:"radio",checked:l===g,name:"selection",value:g,"aria-labelledby":"traffic chart type "+g,onChange:r,className:i}),m.createElement("div",{className:_.cnt},m.createElement(e,u({},d))))))}const _e={legend:{display:!1},scales:{xAxes:[{display:!1}],yAxes:[{display:!1}]}},D=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],we=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],Ie=D;function Ne({id:e}){const n=Z.read(),l=t.exports.useMemo(()=>({labels:Ie,datasets:[E(u(u({},T),$[e].up),{data:D}),E(u(u({},T),$[e].down),{data:we})]}),[e]),s="chart-"+e;return ee(n,s,l,null,_e),m.createElement("div",{style:{width:100,padding:5}},m.createElement("canvas",{id:s}))}const{useEffect:U,useState:Le,useCallback:f,useRef:Pe,useMemo:Oe}=X,Re=[{id:0},{id:1},{id:2},{id:3}],Ae=[["debug","Debug"],["warning","Warning"],["info","Info"],["error","Error"],["silent","Silent"]],Te=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"}],$e=[["zh","\u4E2D\u6587"],["en","English"]],Me=[["Global","Global"],["Rule","Rule"],["Direct","Direct"]],je=e=>({configs:te(e),apiConfig:B(e)}),Be=e=>({selectedChartStyleIndex:ce(e),latencyTestUrl:ie(e),apiConfig:B(e)}),De=j(Be)(Ve);var Fe=j(je)(Ue);function Ue({dispatch:e,configs:n,apiConfig:l}){return U(()=>{e(ne(l))},[e,l]),t.exports.createElement(De,{configs:n})}function Ve({dispatch:e,configs:n,selectedChartStyleIndex:l,latencyTestUrl:s,apiConfig:i}){const[r,d]=Le(n),g=Pe(n);U(()=>{g.current!==n&&d(n),g.current=n},[n]);const b=f(()=>{e(ae("apiConfig"))},[e]),x=f((a,o)=>{d(E(u({},r),{[a]:o}))},[r]),V=f(a=>{const o="allow-lan",p=a;x(o,p),e(k(i,{"allow-lan":p}))},[i,e,x]),h=f(({name:a,value:o})=>{switch(a){case"mode":case"log-level":x(a,o),e(k(i,{[a]:o})),a==="log-level"&&Y(E(u({},i),{logLevel:o}));break;case"redir-port":case"socks-port":case"mixed-port":case"port":if(o!==""){const p=parseInt(o,10);if(p<0||p>65535)return}x(a,o);break;default:return}},[i,e,x]),z=f(a=>h(a.target),[h]),{selectChartStyleIndex:G,updateAppConfig:w}=le(),I=f(a=>{const o=a.target,{name:p,value:L}=o;switch(p){case"port":case"socks-port":case"mixed-port":case"redir-port":{const y=parseInt(L,10);if(y<0||y>65535)return;e(k(i,{[p]:y}));break}case"latencyTestUrl":{w(p,L);break}default:throw new Error(`unknown input name ${p}`)}},[i,e,w]),H=Oe(()=>{const a=r.mode;return typeof a=="string"&&a[0].toUpperCase()+a.slice(1)},[r.mode]),{t:C,i18n:N}=W();return t.exports.createElement("div",null,t.exports.createElement(se,{title:C("Config")}),t.exports.createElement("div",{className:c.root},Te.map(a=>r[a.key]!==void 0?t.exports.createElement("div",{key:a.key},t.exports.createElement("div",{className:c.label},a.label),t.exports.createElement(ge,{name:a.key,value:r[a.key],onChange:z,onBlur:I})):null),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Mode"),t.exports.createElement(S,{options:Me,selected:H,onChange:a=>h({name:"mode",value:a.target.value})})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Log Level"),t.exports.createElement(S,{options:Ae,selected:r["log-level"],onChange:a=>h({name:"log-level",value:a.target.value})})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Allow LAN"),t.exports.createElement("div",{className:c.wrapSwitch},t.exports.createElement(re,{name:"allow-lan",checked:r["allow-lan"],onChange:V})))),t.exports.createElement("div",{className:c.sep},t.exports.createElement("div",null)),t.exports.createElement("div",{className:c.section},t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},C("latency_test_url")),t.exports.createElement(fe,{name:"latencyTestUrl",type:"text",value:s,onBlur:I})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},C("lang")),t.exports.createElement("div",null,t.exports.createElement(S,{options:$e,selected:N.language,onChange:a=>N.changeLanguage(a.target.value)}))),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},C("chart_style")),t.exports.createElement(ke,{OptionComponent:Ne,optionPropsList:Re,selectedIndex:l,onChange:G})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Action"),t.exports.createElement(oe,{start:t.exports.createElement(Q,{size:16}),label:"Switch backend",onClick:b}))))}export{Fe as default};
