var _e=Object.defineProperty,he=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var X=(n,e,t)=>e in n?_e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,G=(n,e)=>{for(var t in e||(e={}))ve.call(e,t)&&X(n,t,e[t]);if(Q)for(var t of Q(e))Ee.call(e,t)&&X(n,t,e[t]);return n},H=(n,e)=>he(n,pe(e));var k=(n,e,t)=>new Promise((a,F)=>{var u=i=>{try{x(t.next(i))}catch(f){F(f)}},g=i=>{try{x(t.throw(i))}catch(f){F(f)}},x=i=>i.done?a(i.value):Promise.resolve(i.value).then(u,g);x((t=t.apply(n,e)).next())});import{e as S,Z as ye,$ as ae,a0 as V,n as B,av as J,a9 as T,aa as E,a1 as P,q as _,t as w,x as v,v as y,y as s,P as se,ax as ce,A as c,a4 as R,B as ge,F as $,a5 as N,a6 as L,a7 as z,az as Fe,I as O,O as q,z as W,r as xe,C as be,a3 as Y,H as De,a2 as ue,aA as ke}from"./index.js";import{u as U,s as ee}from"./chunk.83508cf4.js";import{c as le,d as Be,a as te,E as Ce,b as ne,f as oe,e as Z,_ as $e}from"./chunk.e0573588.js";import{E as M}from"./chunk.d60b0c7b.js";const we={class:"file-checkbox"},Ae=["value"],Re=["title"],Se={class:"thumbnail"},Te={class:"file-name"},Oe={class:"file-date"},Ie={class:"file-type"},Pe={class:"file-size"},qe=S({__name:"file",props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},setup(n){const e=n,t=ye.ComputeSize,a=U(),F=ae(),u=V(),g=B(()=>[{name:"\u6253\u5F00",f:h},{name:"\u4E0B\u8F7D",disabled:e.file.fileType==="dir",f:A},{name:"\u79FB\u9664\u6587\u4EF6",f:p},{name:"\u6062\u590D\u6587\u4EF6",f:l}]),x=B(()=>a.checknoxEntries.indexOf(e.file.rootPath)!=-1),i=B(()=>a.copy.type=="move"&&a.copy.values.indexOf(e.file.rootPath)!=-1),f=J.getFileType,p=()=>{const o=e.file;M.confirm(`\u5220\u9664\u6240\u9009\u7684 ${o.name} \u6587\u4EF6, \u662F\u5426\u7EE7\u7EED?`,"\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>k(this,null,function*(){yield r([o.rootPath])})).catch(()=>{})},r=o=>k(this,null,function*(){try{const m={paths:o.filter(D=>D!=null).map(D=>`/local${D}`),force:!0},C=yield T.File.Basic.Recycle.Remove.POST(m);if(C.data){const{success:D,error:I}=C.data;I&&E.Warning(I),D===0&&(E.Success("\u5220\u9664\u6210\u529F"),a.reload())}}catch(m){E.Error(`${m}`)}}),l=()=>{const o=e.file;M.confirm(`\u6062\u590D\u6240\u9009\u7684 ${o.name} \u6587\u4EF6/\u6587\u4EF6\u5939, \u662F\u5426\u7EE7\u7EED?`,"\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88"}).then(()=>k(this,null,function*(){yield d([o.rootPath])})).catch(()=>{})},d=o=>k(this,null,function*(){try{const m={paths:o.filter(D=>D!=null).map(D=>`/local${D}`),force:!0},C=yield T.File.Basic.Recycle.Restore.POST(m);if(C.data){const{success:D,error:I}=C.data;I&&E.Warning(I),D===0&&(E.Success("\u6062\u590D\u6210\u529F"),a.reload())}}catch(m){E.Error(`${m}`)}}),h=()=>{const o=e.file;if(o.fileType==="dir"){b(o);return}switch(o.iconType){case"image":ie();break;case"doc":de(o);break;case"video":fe(o);break;case"music":me(o);break}},A=()=>{const o=e.file;window.open(o.getDownloadUrl()+"?binary=true","_blank")},b=o=>{let m="/";o.rootPath===void 0?m=`/${o.name}`:m=o.rootPath,F.push({query:H(G({},u.query),{path:m})})},ie=()=>{const o=J.getEntriesImages(a.entries,e.index);a.previewImage.values=o,a.previewImage.enable=!0},de=o=>{const m=o.getSuffixName();let C=null;switch(m){case"pdf":C=o.getDownloadUrl();break;case"txt":case"md":case"js":case"yaml":case"yam":case"css":case"ts":case"json":case"html":C=location.pathname+`/#/editor?path=${o.rootPath}`;break}j(C)},j=o=>{if(o==null)return;const m=window.open("about:blank");m&&(m.location.href=o)},fe=o=>{j(o.getDownloadUrl())},me=o=>{j(o.getDownloadUrl())};return(o,m)=>{const C=P("thumbnail");return _(),w(Be,{class:"file",draggable:"true",checkbox:c(x),move:c(i),index:n.index},{default:v(()=>[y(le,{class:"file-container",list:c(g)},{default:v(()=>[s("div",we,[se(s("input",{type:"checkbox",value:n.file.rootPath,"onUpdate:modelValue":m[0]||(m[0]=D=>c(a).checknoxEntries=D)},null,8,Ae),[[ce,c(a).checknoxEntries]])]),s("div",{class:"file-info",onClick:m[1]||(m[1]=ge(D=>h(),["prevent"])),title:n.file.name},[s("div",Se,[y(C,{file:n.file},null,8,["file"])]),s("div",Te,R(n.file.name),1)],8,Re),s("div",Oe,R(n.file.modifiedTime),1),s("div",Ie,R(c(f)(n.file.iconType)),1),s("div",Pe,R(c(t)(n.file.size)),1)]),_:1},8,["list"])]),_:1},8,["checkbox","move","index"])}}}),Me=n=>(N("data-v-582e2fad"),n=n(),L(),n),Ve={class:"notfound"},ze=Me(()=>s("p",null,"\u5F53\u524D\u76EE\u5F55\u6CA1\u6709\u6587\u4EF6\u54E6",-1)),Ue=S({__name:"notfound",setup(n){const e="/luci-static/linkeasefile/icons/notfound.png";return(t,a)=>(_(),$("div",Ve,[s("img",{src:e,alt:""}),ze]))}});const We=z(Ue,[["__scopeId","data-v-582e2fad"]]),Ne=S({__name:"files",setup(n){return k(this,null,function*(){let e,t;const a=U(),F=V(),{path:u}=F.query,g=B(()=>a.config),x=()=>k(this,null,function*(){a.checknoxEntries=[];let i=[];try{const f={path:`/local${u||"/"}`,order:ee.order.get(),orderBy:ee.orderBy.get()};a.config.filter&&a.config.filter!="default"&&(f.filter=a.config.filter);const p=yield T.File.Basic.Recycle.List.POST(f);if(p.data){const{success:r,result:l,error:d}=p.data;r==0&&(i=l.entries||[]),d&&E.Warning(d)}}catch(f){E.Error(`${f}`),console.log(f)}finally{a.entries=J.FileBasicEntryArray(i),i=[]}});return[e,t]=Fe(()=>x()),yield e,t(),(i,f)=>c(a).entries.length>0?(_(),$("div",{key:0,class:W(["files",c(g).model?"list":"model"])},[(_(!0),$(O,null,q(c(a).entries,(p,r)=>(_(),w(qe,{file:p,index:r},null,8,["file","index"]))),256))],2)):(_(),w(We,{key:1,entries:c(a).entries},null,8,["entries"]))})}});const Le=z(Ne,[["__scopeId","data-v-41d38675"]]),re=n=>(N("data-v-190fc61d"),n=n(),L(),n),je={class:"f"},Ge={class:"setting"},He=re(()=>s("em",null,null,-1)),Ze=re(()=>s("em",null,null,-1)),Je=S({__name:"checkbox",setup(n){const e=xe(!1),t=U(),a=B(()=>(e.value=t.checknoxEntries.length>0,t.checknoxEntries||[])),F=()=>{if(t.entries.length==0){e.value=!1;return}if(t.checknoxEntries.length>0)t.checknoxEntries=[];else{const r=[];let l=t.entries.length;for(let d=0;d<l;d++)r.push(t.entries[d].rootPath);t.checknoxEntries=r}e.value=t.checknoxEntries.length>0},u=()=>{M.confirm("\u6E05\u7A7A\u56DE\u6536\u7AD9\u7684\u6240\u6709\u6587\u4EF6, \u662F\u5426\u7EE7\u7EED?","\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"error"}).then(()=>k(this,null,function*(){yield g()})).catch(()=>{})},g=()=>k(this,null,function*(){try{const r={path:"/local"},l=yield T.File.Basic.Recycle.Clear.POST(r);if(l.data){const{success:d,error:h}=l.data;h&&E.Warning(h),d===0&&(E.Success("\u6E05\u7A7A\u56DE\u6536\u7AD9\u6210\u529F"),t.reload())}}catch(r){E.Error(`${r}`)}}),x=()=>{const r=t.checknoxEntries.length;M.confirm(`\u6E05\u7A7A\u56DE\u6536\u7AD9\u6240\u9009\u7684 ${r} \u4E2A\u6587\u4EF6\u6216\u6587\u4EF6\u5939, \u662F\u5426\u7EE7\u7EED?`,"\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"error"}).then(()=>k(this,null,function*(){yield i(t.checknoxEntries)})).catch(()=>{})},i=r=>k(this,null,function*(){try{const l={paths:r.filter(h=>h!=null).map(h=>`/local${h}`),force:!0},d=yield T.File.Basic.Recycle.Remove.POST(l);if(d.data){const{success:h,error:A}=d.data;A&&E.Warning(A),h===0&&(E.Success("\u5220\u9664\u6210\u529F"),t.reload())}}catch(l){E.Error(`${l}`)}}),f=()=>{const r=t.checknoxEntries.length;M.confirm(`\u6062\u590D\u56DE\u6536\u7AD9\u6240\u9009\u7684 ${r} \u4E2A\u6587\u4EF6\u6216\u6587\u4EF6\u5939, \u662F\u5426\u7EE7\u7EED?`,"\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88"}).then(()=>k(this,null,function*(){yield p(t.checknoxEntries)})).catch(()=>{})},p=r=>k(this,null,function*(){try{const l={paths:r.filter(h=>h!=null).map(h=>`/local${h}`),force:!0},d=yield T.File.Basic.Recycle.Restore.POST(l);if(d.data){const{success:h,error:A}=d.data;A&&E.Warning(A),h===0&&(E.Success("\u6062\u590D\u6210\u529F"),t.reload())}}catch(l){E.Error(`${l}`)}});return(r,l)=>(_(),$("div",je,[s("label",null,[se(s("input",{type:"checkbox",value:!1,"onUpdate:modelValue":l[0]||(l[0]=d=>e.value=d),onChange:F},null,544),[[ce,e.value]]),s("span",null,R(c(a).length>0?`\u5DF2\u9009\u4E2D${c(a).length}\u4E2A\u6587\u4EF6/\u6587\u4EF6\u5939`:"\u5168\u9009"),1)]),s("div",Ge,[s("button",{onClick:l[1]||(l[1]=d=>u())},"\u6E05\u7A7A\u56DE\u6536\u7AD9"),c(a).length>0?(_(),$(O,{key:0},[He,s("button",{onClick:l[2]||(l[2]=d=>x())},"\u6E05\u7A7A\u9009\u4E2D"),Ze,s("button",{onClick:l[3]||(l[3]=d=>f())},"\u6062\u590D\u9009\u4E2D")],64)):be("",!0)])]))}});const Ke=z(Je,[["__scopeId","data-v-190fc61d"]]),Qe=S({__name:"nav",setup(n){const e=V(),t=ae(),a=B(()=>e.query),F=B(()=>a.value.path||""),u=B(()=>(F.value||"").split("/")||[]),g=B(()=>{var i;return u.value&&u.value.length>0?(i=u.value)==null?void 0:i.splice(1):[]}),x=i=>{const f=g.value.slice(0,i+1);t.push({query:H(G({},e.query),{path:"/"+f.join("/")})})};return(i,f)=>(_(),w(c(ue),{class:"page-nav-container"},{default:v(()=>[y(c(Ce),{"separator-icon":c(De),class:"nav-breadcrumb"},{default:v(()=>[c(g)&&c(g).length>0?(_(!0),$(O,{key:0},q(c(g),(p,r)=>(_(),w(c(te),{onClick:l=>x(r),class:"nav-breadcrumb_item"},{default:v(()=>[Y(R(r==0?"\u6839\u76EE\u5F55":p),1)]),_:2},1032,["onClick"]))),256)):(_(),w(c(te),{key:1,onClick:f[0]||(f[0]=p=>x(0)),class:"nav-breadcrumb_item"},{default:v(()=>[Y(" \u6839\u76EE\u5F55 ")]),_:1}))]),_:1},8,["separator-icon"])]),_:1}))}}),K=n=>(N("data-v-cc8dcce8"),n=n(),L(),n),Xe={class:"tools"},Ye={class:"tool-item"},et=K(()=>s("em",null,null,-1)),tt=K(()=>s("em",null,null,-1)),nt={class:"tool-item"},ot=K(()=>s("em",null,null,-1)),at={class:"tool-item"},st=S({__name:"tools",setup(n){const e=U(),t=ke(e.config),a=[{name:"\u540D\u79F0",label:"filename"},{name:"\u65F6\u95F4",label:"date"},{name:"\u5927\u5C0F",label:"size"},{name:"\u7C7B\u578B",label:"filetype"}],F=[{name:"\u9012\u589E",label:"asc"},{name:"\u9012\u51CF",label:"desc"}],u=[{name:"\u5168\u90E8",label:"default"},{name:"\u56FE\u7247",label:"image"},{name:"\u538B\u7F29\u6587\u4EF6",label:"archive"},{name:"\u89C6\u9891",label:"video"},{name:"\u97F3\u4E50",label:"music"},{name:"\u6587\u6863",label:"doc"},{name:"\u5176\u5B83",label:"other"}],g=V();B(()=>g.query.path);const x=()=>{e.setConfigModel()},i=p=>{switch(p){case"date":case"size":case"filetype":case"filename":e.setConfigOrder(p);break;case"desc":case"asc":e.setConfigOrderBy(p);break}e.reload()},f=p=>{e.setConfigFilter(p),e.reload()};return(p,r)=>{const l=P("icon-sort-file"),d=P("icon-category"),h=P("icon-model-file"),A=P("icon-list-file");return _(),$("div",Xe,[s("div",Ye,[y(c(oe),{onCommand:i},{dropdown:v(()=>[y(c(ne),null,{default:v(()=>[(_(),$(O,null,q(a,b=>y(c(Z),{class:W(["sort-item",{on:b.label==t.order}]),command:b.label},{default:v(()=>[et,s("span",null,R(b.name),1)]),_:2},1032,["class","command"])),64)),(_(),$(O,null,q(F,b=>y(c(Z),{class:W(["sort-item",{on:b.label==t.orderBy}]),command:b.label},{default:v(()=>[tt,s("span",null,R(b.name),1)]),_:2},1032,["class","command"])),64))]),_:1})]),default:v(()=>[s("button",null,[y(l)])]),_:1})]),s("div",nt,[y(c(oe),{onCommand:f},{dropdown:v(()=>[y(c(ne),null,{default:v(()=>[(_(),$(O,null,q(u,b=>y(c(Z),{class:W(["sort-item",{on:b.label==t.filter}]),command:b.label},{default:v(()=>[ot,s("span",null,R(b.name),1)]),_:2},1032,["class","command"])),64))]),_:1})]),default:v(()=>[s("button",null,[y(d)])]),_:1})]),s("div",at,[s("button",{onClick:r[0]||(r[0]=b=>x())},[t.model?(_(),w(h,{key:0})):(_(),w(A,{key:1}))])])])}}});const ct=z(st,[["__scopeId","data-v-cc8dcce8"]]),ut=n=>(N("data-v-ac171980"),n=n(),L(),n),lt={class:"page-tool-container"},rt=ut(()=>s("div",{class:"auto"},null,-1)),it=S({__name:"index",setup(n){const e=U(),t=V(),a=B(()=>t.query.path||""),F=B(()=>{const u=e.config;return[{name:"\u67E5\u770B",children:[{name:"\u5217\u8868",active:u.model,f:e.setConfigModel},{name:"\u7565\u7F29\u56FE",active:!u.model,f:e.setConfigModel}]},{name:"\u6392\u5E8F\u65B9\u5F0F",children:[{name:"\u540D\u79F0",active:u.order=="filename",f:()=>{e.setConfigOrder("filename"),e.reload()}},{name:"\u65F6\u95F4",active:u.order=="date",f:()=>{e.setConfigOrder("date"),e.reload()}},{name:"\u5927\u5C0F",active:u.order=="size",f:()=>{e.setConfigOrder("size"),e.reload()}},{name:"\u7C7B\u578B",active:u.order=="filetype",f:()=>{e.setConfigOrder("filetype"),e.reload()}},{name:"\u9012\u589E",active:u.orderBy=="asc",f:()=>{e.setConfigOrderBy("asc"),e.reload()}},{name:"\u9012\u51CF",active:u.orderBy=="desc",f:()=>{e.setConfigOrderBy("desc"),e.reload()}}]},{name:"\u6587\u4EF6\u8FC7\u6EE4",children:[{name:"\u5168\u90E8",active:u.filter=="default",f:()=>{e.setConfigFilter("default"),e.reload()}},{name:"\u56FE\u7247",active:u.filter=="image",f:()=>{e.setConfigFilter("image"),e.reload()}},{name:"\u538B\u7F29\u6587\u4EF6",active:u.filter=="archive",f:()=>{e.setConfigFilter("archive"),e.reload()}},{name:"\u89C6\u9891",active:u.filter=="video",f:()=>{e.setConfigFilter("video"),e.reload()}},{name:"\u97F3\u4E50",active:u.filter=="music",f:()=>{e.setConfigFilter("music"),e.reload()}},{name:"\u6587\u6863",active:u.filter=="doc",f:()=>{e.setConfigFilter("doc"),e.reload()}},{name:"\u5176\u5B83",active:u.filter=="other",f:()=>{e.setConfigFilter("other"),e.reload()}}]},{name:"\u5237\u65B0",f:()=>{e.reload()}},{name:"\u91CD\u65B0\u52A0\u8F7D",f:()=>{location.reload()}}]});return(u,g)=>(_(),w($e,{id:"page"},{default:v(()=>[y(le,{class:"page-container",list:c(F)},{default:v(()=>[y(Qe),s("div",lt,[y(Ke),rt,y(ct)]),y(c(ue),{class:"page-body-container"},{default:v(()=>[(_(),w(Le,{key:`${c(a)}`}))]),_:1})]),_:1},8,["list"])]),_:1}))}});const pt=z(it,[["__scopeId","data-v-ac171980"]]);export{pt as default};
