var Qe=Object.defineProperty,Ze=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var be=Object.getOwnPropertySymbols;var tt=Object.prototype.hasOwnProperty,nt=Object.prototype.propertyIsEnumerable;var Ne=(e,t,n)=>t in e?Qe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,C=(e,t)=>{for(var n in t||(t={}))tt.call(t,n)&&Ne(e,n,t[n]);if(be)for(var n of be(t))nt.call(t,n)&&Ne(e,n,t[n]);return e},k=(e,t)=>Ze(e,et(t));import{E as Pe,i as st,r as l,c as g,f as ot,R as O,a as rt,b as z,d as ce,u as A,e as q,g as at,h as o,j as Se,k as ie,l as lt,A as ct,F as it,m as ut,N as mt,n as dt,o as pt,p as J,S as ft,q as ke,s as ht,H as xt}from"./vendor.16dac984.js";function _(){return navigator.userAgent==="ClashX Runtime"}let b=null;class Et{constructor(t){this.instance=null,window.WebViewJavascriptBridge&&(this.instance=window.WebViewJavascriptBridge),this.initBridge(n=>{this.instance=n,t()})}initBridge(t){if(!_())return t==null?void 0:t(null);if(window.WebViewJavascriptBridge)return t(window.WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(t);window.WVJBCallbacks=[t];const n=document.createElement("iframe");n.style.display="none",n.src="https://__bridge_loaded__",document.documentElement.appendChild(n),setTimeout(()=>document.documentElement.removeChild(n),0)}callHandler(t,n){return new Promise(r=>{var s;(s=this.instance)==null||s.callHandler(t,n,r)})}ping(){return this.callHandler("ping")}readConfigString(){return this.callHandler("readConfigString")}getPasteboard(){return this.callHandler("getPasteboard")}getAPIInfo(){return this.callHandler("apiInfo")}setPasteboard(t){return this.callHandler("setPasteboard",t)}writeConfigWithString(t){return this.callHandler("writeConfigWithString",t)}setSystemProxy(t){return this.callHandler("setSystemProxy",t)}getStartAtLogin(){return this.callHandler("getStartAtLogin")}getProxyDelay(t){return this.callHandler("speedTest",t)}setStartAtLogin(t){return this.callHandler("setStartAtLogin",t)}isSystemProxySet(){return this.callHandler("isSystemProxySet")}}function gt(e){if(b){e();return}b=new Et(e)}var X;(function(e){e.SPEED_NOTIFY="speed-notify"})(X||(X={}));class yt{constructor(){this.EE=new Pe}notifySpeedTest(){this.EE.emit(X.SPEED_NOTIFY)}subscribe(t,n){this.EE.addListener(t,n)}unsubscribe(t,n){this.EE.removeListener(t,n)}}var ue=new yt;function K(e,t=""){return window.localStorage.getItem(e)||t}function Q(e,t){return window.localStorage.setItem(e,t)}function $(){}function Z(e){return new URLSearchParams(window.location.search).get(e)}function vt(e,t){const n=[],r=[];for(const s of e)t(s)?n.push(s):r.push(s);return[n,r]}function me(e){const[t,n]=st(e),r=l.exports.useMemo(()=>{function s(a,c){typeof a=="string"?n(i=>{const u=a,p=c;i[u]=p}):typeof a=="function"?n(a):typeof a=="object"&&n(i=>{const u=a;for(const p of Object.keys(u)){const m=p;i[m]=u[m]}})}return s},[n]);return[t,r]}function wt(e,t=0){if(e.length<2)throw new Error("List requires at least two elements");const[n,r]=l.exports.useState(t);function s(){r((n+1)%e.length)}return{current:l.exports.useMemo(()=>e[n],[e,n]),next:s}}function de(e=!1){const[t,n]=l.exports.useState(e);function r(){n(!1)}function s(){n(!0)}return{visible:t,hide:r,show:s}}function H(e){const{title:t,children:n,className:r,style:s}=e;return l.exports.createElement("header",{className:g("header",r),style:s},l.exports.createElement("h1",{className:"md:text-xl"},t),l.exports.createElement("div",{className:"flex flex-auto items-center justify-end"},n))}function B(e){const{type:t,size:n=14,className:r,style:s}=e,a=g("clash-iconfont",`icon-${t}`,r),c=C({fontSize:n},s),i=k(C({},e),{className:a,style:c});return l.exports.createElement("i",C({},i))}function pe(e){const{className:t,checked:n=!1,disabled:r=!1,onChange:s=$}=e,a=g("switch",{checked:n,disabled:r},t);function c(){r||s(!n)}return l.exports.createElement("div",{className:a,onClick:c},l.exports.createElement(B,{className:"switch-icon font-bold",type:"check",size:20}))}function M(e){const{className:t,style:n,children:r}=e;return l.exports.createElement("div",{className:g("card",t),style:n},r)}function Fe(e){const{options:t,value:n,onSelect:r}=e;return l.exports.createElement("div",{className:"button-select"},t.map(s=>l.exports.createElement("button",{value:s.value,key:s.value,className:g("button-select-options",{actived:n===s.value}),onClick:()=>r==null?void 0:r(s.value)},s.label)))}const Ct={SideBar:{Proxies:"Proxies",Overview:"Overview",Logs:"Logs",Rules:"Rules",Settings:"Setting",Connections:"Connections",Version:"Version"},Settings:{title:"Settings",labels:{startAtLogin:"Start at login",language:"language",setAsSystemProxy:"Set as system proxy",allowConnectFromLan:"Allow connect from Lan",proxyMode:"Mode",socks5ProxyPort:"Socks5 proxy port",httpProxyPort:"HTTP proxy port",mixedProxyPort:"Mixed proxy port",externalController:"External controller"},values:{cn:"\u4E2D\u6587",en:"English",global:"Global",rules:"Rules",direct:"Direct",script:"Script"},versionString:"Current ClashX is the latest version\uFF1A{{version}}",checkUpdate:"Check Update",externalControllerSetting:{title:"External Controller",note:"Please note that modifying this configuration will only configure Dashboard. Will not modify your Clash configuration file. Please make sure that the external controller address matches the address in the Clash configuration file, otherwise, Dashboard will not be able to connect to Clash.",host:"Host",port:"Port",secret:"Secret"}},Logs:{title:"Logs"},Rules:{title:"Rules",providerTitle:"Providers",providerUpdateTime:"Last updated at",ruleCount:"Rule count"},Connections:{title:"Connections",keepClosed:"Keep closed connections",total:{text:"total",upload:"upload",download:"download"},closeAll:{title:"Warning",content:"This would close all connections"},filter:{all:"All"},columns:{host:"Host",network:"Network",type:"Type",chains:"Chains",rule:"Rule",time:"Time",speed:"Speed",upload:"Upload",download:"Download",sourceIP:"Source IP"}},Proxies:{title:"Proxies",editDialog:{title:"Edit Proxy",color:"Color",name:"Name",type:"Type",server:"Server",port:"Port",password:"Password",cipher:"Cipher",obfs:"Obfs","obfs-host":"Obfs-host",uuid:"UUID",alterId:"AlterId",tls:"TLS"},groupTitle:"Policy Group",providerTitle:"Providers",providerUpdateTime:"Last updated at",expandText:"Expand",collapseText:"Collapse",speedTestText:"Speed Test",breakConnectionsText:"Close connections which include the group"},Modal:{ok:"Ok",cancel:"Cancel"}},bt={SideBar:{Proxies:"\u4EE3\u7406",Overview:"\u603B\u89C8",Logs:"\u65E5\u5FD7",Rules:"\u89C4\u5219",Settings:"\u8BBE\u7F6E",Connections:"\u8FDE\u63A5",Version:"\u7248\u672C"},Settings:{title:"\u8BBE\u7F6E",labels:{startAtLogin:"\u5F00\u673A\u65F6\u542F\u52A8",language:"\u8BED\u8A00",setAsSystemProxy:"\u8BBE\u7F6E\u4E3A\u7CFB\u7EDF\u4EE3\u7406",allowConnectFromLan:"\u5141\u8BB8\u6765\u81EA\u5C40\u57DF\u7F51\u7684\u8FDE\u63A5",proxyMode:"\u4EE3\u7406\u6A21\u5F0F",socks5ProxyPort:"Socks5 \u4EE3\u7406\u7AEF\u53E3",httpProxyPort:"HTTP \u4EE3\u7406\u7AEF\u53E3",mixedProxyPort:"\u6DF7\u5408\u4EE3\u7406\u7AEF\u53E3",externalController:"\u5916\u90E8\u63A7\u5236\u8BBE\u7F6E"},values:{cn:"\u4E2D\u6587",en:"English",global:"\u5168\u5C40",rules:"\u89C4\u5219",direct:"\u76F4\u8FDE",script:"\u811A\u672C"},versionString:"\u5F53\u524D ClashX \u5DF2\u662F\u6700\u65B0\u7248\u672C\uFF1A{{version}}",checkUpdate:"\u68C0\u67E5\u66F4\u65B0",externalControllerSetting:{title:"\u7F16\u8F91\u5916\u90E8\u63A7\u5236\u8BBE\u7F6E",note:"\u8BF7\u6CE8\u610F\uFF0C\u4FEE\u6539\u8BE5\u914D\u7F6E\u9879\u5E76\u4E0D\u4F1A\u4FEE\u6539\u4F60\u7684 Clash \u914D\u7F6E\u6587\u4EF6\uFF0C\u8BF7\u786E\u8BA4\u4FEE\u6539\u540E\u7684\u5916\u90E8\u63A7\u5236\u5730\u5740\u548C Clash \u914D\u7F6E\u6587\u4EF6\u5185\u7684\u5730\u5740\u4E00\u81F4\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4 Dashboard \u65E0\u6CD5\u8FDE\u63A5\u3002",host:"Host",port:"\u7AEF\u53E3",secret:"\u5BC6\u94A5"}},Logs:{title:"\u65E5\u5FD7"},Rules:{title:"\u89C4\u5219",providerTitle:"\u89C4\u5219\u96C6",providerUpdateTime:"\u6700\u540E\u66F4\u65B0\u4E8E",ruleCount:"\u89C4\u5219\u6761\u6570"},Connections:{title:"\u8FDE\u63A5",keepClosed:"\u4FDD\u7559\u5173\u95ED\u8FDE\u63A5",total:{text:"\u603B\u91CF",upload:"\u4E0A\u4F20",download:"\u4E0B\u8F7D"},closeAll:{title:"\u8B66\u544A",content:"\u5C06\u4F1A\u5173\u95ED\u6240\u6709\u8FDE\u63A5"},filter:{all:"\u5168\u90E8"},columns:{host:"\u57DF\u540D",network:"\u7F51\u7EDC",type:"\u7C7B\u578B",chains:"\u8282\u70B9\u94FE",rule:"\u89C4\u5219",time:"\u8FDE\u63A5\u65F6\u95F4",speed:"\u901F\u7387",upload:"\u4E0A\u4F20",download:"\u4E0B\u8F7D",sourceIP:"\u6765\u6E90 IP"}},Proxies:{title:"\u4EE3\u7406",editDialog:{title:"\u7F16\u8F91\u4EE3\u7406",color:"\u989C\u8272",name:"\u540D\u5B57",type:"\u7C7B\u578B",server:"\u670D\u52A1\u5668",port:"\u7AEF\u53E3",password:"\u5BC6\u7801",cipher:"\u52A0\u5BC6\u65B9\u5F0F",obfs:"Obfs","obfs-host":"Obfs-host",uuid:"UUID",alterId:"AlterId",tls:"TLS"},groupTitle:"\u7B56\u7565\u7EC4",providerTitle:"\u4EE3\u7406\u96C6",providerUpdateTime:"\u6700\u540E\u66F4\u65B0\u4E8E",expandText:"\u5C55\u5F00",collapseText:"\u6536\u8D77",speedTestText:"\u6D4B\u901F",breakConnectionsText:"\u5207\u6362\u65F6\u6253\u65AD\u5305\u542B\u7B56\u7565\u7EC4\u7684\u8FDE\u63A5"},Modal:{ok:"\u786E \u5B9A",cancel:"\u53D6 \u6D88"}},De={en_US:Ct,zh_CN:bt},Ae="language",Le=Object.keys(De);function Nt(){const e=[];if(window.navigator)if(window.navigator.languages)for(const t of window.navigator.languages)e.push(t);else window.navigator.language&&e.push(navigator.language);return e}function Pt(){const e=K(Ae);if(e&&Le.includes(e))return e;const t=Nt();for(const n of t){if(n.includes("zh"))return"zh_CN";if(n.includes("us"))return"en_US"}return"en_US"}function St(e){Q(Ae,e)}function fe(e){return l.exports.useMemo(()=>{function n(r,s){if(typeof r=="string")e(a=>{const c=r,i=s;a[c]=i});else if(typeof r=="function"){const a=r;e(c=>a(c))}else typeof r=="object"&&e(a=>ot(a,c=>{const i=r;for(const u of Object.keys(i)){const p=u;c[p]=i[p]}}))}return n},[e])}function he(e){let t=null;return async function(){return t||(t=e(),t.catch(n=>{throw t=null,n}))}}class Te{constructor(t){this.EE=new Pe,this.innerBuffer=[],this.isClose=!1,this.config=Object.assign({bufferLength:0,retryInterval:5e3,headers:{}},t),this.config.useWebsocket?this.websocketLoop():this.loop()}websocketLoop(){var r;const t=new URL(this.config.url);t.protocol=t.protocol==="http:"?"ws:":"wss:",t.searchParams.set("token",(r=this.config.token)!=null?r:"");const n=new WebSocket(t.toString());n.addEventListener("message",s=>{const a=JSON.parse(s.data);this.EE.emit("data",[a]),this.config.bufferLength>0&&(this.innerBuffer.push(a),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))}),n.addEventListener("close",()=>setTimeout(this.websocketLoop,this.config.retryInterval)),n.addEventListener("error",s=>{this.EE.emit("error",s),setTimeout(this.websocketLoop,this.config.retryInterval)})}async loop(){const t=await O.fromPromise(fetch(this.config.url,{mode:"cors",headers:this.config.token?{Authorization:`Bearer ${this.config.token}`}:{}}),s=>s);if(t.isErr()){this.retry(t.error);return}else if(!t.value.body){this.retry(new Error("fetch body error"));return}const n=t.value.body.getReader(),r=new TextDecoder;for(;!this.isClose;){const s=await O.fromPromise(n==null?void 0:n.read(),i=>i);if(s.isErr()){this.retry(s.error);break}const c=r.decode(s.value.value).trim().split(`
`).map(i=>JSON.parse(i));this.EE.emit("data",c),this.config.bufferLength>0&&(this.innerBuffer.push(...c),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))}}retry(t){this.isClose||(this.EE.emit("error",t),window.setTimeout(this.loop,this.config.retryInterval))}subscribe(t,n){this.EE.addListener(t,n)}unsubscribe(t,n){this.EE.removeListener(t,n)}buffer(){return this.innerBuffer.slice()}destory(){this.EE.removeAllListeners(),this.isClose=!0}}async function ee(){var a,c,i,u,p,m,f,h,N;if(_()){const v=await b.getAPIInfo();return{hostname:v.host,port:v.port,secret:v.secret,protocol:"http:"}}let e;{const v=document.querySelector('meta[name="external-controller"]');((a=v==null?void 0:v.content)==null?void 0:a.match(/^https?:/))&&(e=new URL(v.content))}const t=(i=Z("host"))!=null?i:K("externalControllerAddr",(c=e==null?void 0:e.hostname)!=null?c:"127.0.0.1"),n=(p=Z("port"))!=null?p:K("externalControllerPort",(u=e==null?void 0:e.port)!=null?u:"9090"),r=(f=Z("secret"))!=null?f:K("secret",(m=e==null?void 0:e.username)!=null?m:""),s=((h=Z("protocol"))!=null?h:t==="127.0.0.1")?"http:":(N=e==null?void 0:e.protocol)!=null?N:window.location.protocol;if(!t||!n)throw new Error("can't get hostname or port");return{hostname:t,port:n,secret:r,protocol:s}}const P=he(async()=>{const{hostname:e,port:t,secret:n,protocol:r}=await ee();return rt.create({baseURL:`${r}//${e}:${t}`,headers:n?{Authorization:`Bearer ${n}`}:{}})});async function Be(){return(await P()).get("configs")}async function Y(e){return(await P()).patch("configs",e)}async function kt(){return(await P()).get("rules")}async function Ft(){return(await P()).get("providers/proxies",{validateStatus(t){return t>=200&&t<300||t===404}}).then(t=>(t.status===404&&(t.data={providers:{}}),t))}async function Dt(){return(await P()).get("providers/rules")}async function At(e){return(await P()).put(`providers/proxies/${encodeURIComponent(e)}`)}async function Lt(e){return(await P()).put(`providers/rules/${encodeURIComponent(e)}`)}async function Tt(e){return(await P()).get(`providers/proxies/${encodeURIComponent(e)}/healthcheck`)}async function Bt(){return(await P()).get("proxies")}async function xe(){return(await P()).get("version")}async function It(e){return(await P()).get(`proxies/${encodeURIComponent(e)}/delay`,{params:{timeout:5e3,url:"http://www.gstatic.com/generate_204"}})}async function Rt(){return(await P()).delete("connections")}async function $t(e){return(await P()).delete(`connections/${e}`)}async function Ht(){return(await P()).get("connections")}async function Mt(e,t){return(await P()).put(`proxies/${encodeURIComponent(e)}`,{name:t})}const Ie=he(async function(){const e=await ee(),{data:t}=await Be(),n=await O.fromPromise(xe(),c=>c),s=!!(n.isErr()?"unkonwn version":n.value.data.version)||!0,a=`${e.protocol}//${e.hostname}:${e.port}/logs?level=${t["log-level"]}`;return new Te({url:a,bufferLength:200,token:e.secret,useWebsocket:s})}),Ut=he(async function(){const e=await ee(),t=await O.fromPromise(xe(),a=>a),r=!!(t.isErr()?"unkonwn version":t.value.data.version)||!0,s=`${e.protocol}//${e.hostname}:${e.port}/connections`;return new Te({url:s,bufferLength:200,token:e.secret,useWebsocket:r})}),Ot=z(!0);function Ee(){const[e,t]=A(Ot);function n(r){return async function(...s){var c;const a=await O.fromPromise(r(...s),i=>i);if(a.isErr())throw((c=a.error.response)==null?void 0:c.status)===401&&t(!1),a.error;return t(!0),a.value}}return{identity:e,wrapFetcher:n,set:t}}const qt=z(Pt());function S(){const[e,t]=A(qt);function n(s){t(s),St(s)}const r=l.exports.useCallback(function(s){function a(c){return at(De[e][s],c)}return{t:a}},[e]);return{lang:e,locales:Le,setLang:n,translation:r}}const Re=z({version:"",premium:!1});function $e(){const[e,t]=A(Re),{set:n}=Ee();async function r(){const s=await O.fromPromise(xe(),a=>a);n(s.isOk()),t(s.isErr()?{version:"",premium:!1}:{version:s.value.data.version,premium:!!s.value.data.premium})}return{version:e.version,premium:e.premium,update:r}}function He(){const[{premium:e}]=A(Re),{data:t,mutate:n}=q("/providers/rule",async()=>{if(!e)return[];const r=await Dt();return Object.keys(r.data.providers).map(s=>r.data.providers[s])});return{providers:t!=null?t:[],update:n}}const Wt=ce({breakConnections:!1});function Me(){const[e,t]=A(Wt);return{data:e,set:fe(t)}}const Ue=z([]);function Oe(){const[e,t]=A(Ue),{data:n,mutate:r}=q("/providers/proxy",async()=>{const s=await Ft();return Object.keys(s.data.providers).map(a=>s.data.providers[a]).filter(a=>a.name!=="default").filter(a=>a.vehicleType!=="Compatible")});return l.exports.useEffect(()=>t(n!=null?n:[]),[n,t]),{providers:e,update:r}}function qe(){const{data:e,mutate:t}=q("/config",async()=>{var s;const r=(await Be()).data;return{port:r.port,socksPort:r["socks-port"],mixedPort:(s=r["mixed-port"])!=null?s:0,redirPort:r["redir-port"],mode:r.mode.toLowerCase(),logLevel:r["log-level"],allowLan:r["allow-lan"]}});return{general:e!=null?e:{},update:t}}const We=ce({proxies:[],groups:[],global:{name:"GLOBAL",type:"Selector",now:"",history:[],all:[]}});function te(){const[e,t]=A(We),n=fe(t),{mutate:r}=q("/proxies",async()=>{const a=await Bt(),c=a.data.proxies.GLOBAL;c.name="GLOBAL";const i=new Set(["Selector","URLTest","Fallback","LoadBalance"]),u=new Set(["DIRECT","REJECT","GLOBAL"]),p=c.all.filter(h=>!u.has(h)).map(h=>k(C({},a.data.proxies[h]),{name:h})),[m,f]=vt(p,h=>!i.has(h.type));n({proxies:m,groups:f,global:c})}),s=l.exports.useCallback((a,c)=>{n(i=>{a==="GLOBAL"&&(i.global.now=c);for(const u of i.groups)u.name===a&&(u.now=c)})},[n]);return{proxies:e.proxies,groups:e.groups,global:e.global,update:r,markProxySelected:s,set:n}}const zt=z(e=>{const t=e(We),n=e(Ue),r=new Map;for(const s of t.proxies)r.set(s.name,s);for(const s of n)for(const a of s.proxies)r.set(a.name,a);return r});function ze(){const{data:e,mutate:t}=q("/clashx",async()=>{var s,a;if(!_())return{isClashX:!1,startAtLogin:!1,systemProxy:!1};const n=(s=await(b==null?void 0:b.getStartAtLogin()))!=null?s:!1,r=(a=await(b==null?void 0:b.isSystemProxySet()))!=null?a:!1;return{startAtLogin:n,systemProxy:r,isClashX:!0}});return{data:e,update:t}}const _t=z({hostname:"127.0.0.1",port:"9090",secret:""});function _e(){const[e,t]=A(_t),n=l.exports.useCallback(async function(){const a=await ee();t(C({},a))},[t]);async function r(s){const{hostname:a,port:c,secret:i}=s;Q("externalControllerAddr",a),Q("externalControllerPort",c),Q("secret",i),window.location.reload()}return{data:e,fetch:n,update:r}}const Gt=ce([]);function jt(){const[e,t]=A(Gt),n=fe(t);async function r(){const s=await kt();n(s.data.rules)}return{rules:e,update:r}}function Vt(e){const{className:t,data:n,onClick:r,select:s,canClick:a,errSet:c,rowHeight:i}=e,{translation:u}=S(),{t:p}=u("Proxies"),[m,f]=l.exports.useState(!1),[h,N]=l.exports.useState(!1),v=l.exports.useRef(null);l.exports.useLayoutEffect(()=>{var F,T;N(((T=(F=v==null?void 0:v.current)==null?void 0:F.offsetHeight)!=null?T:0)>30)},[]);const L=m?"auto":i,I=a?r:$;function U(){f(!m)}const D=n.map(F=>{const T=g({"tags-selected":s===F,"cursor-pointer":a,error:c==null?void 0:c.has(F)});return o.createElement("li",{className:T,key:F,onClick:()=>I(F)},F)});return o.createElement("div",{className:g("flex items-start overflow-y-hidden",t),style:{height:L}},o.createElement("ul",{ref:v,className:g("tags",{expand:m})},D),h&&o.createElement("span",{className:"h-7 px-5 select-none cursor-pointer leading-7",onClick:U},p(m?"collapseText":"expandText")))}function G(e){const{className:t,style:n,value:r="",align:s="center",inside:a=!1,autoFocus:c=!1,type:i="text",disabled:u=!1,onChange:p=$,onBlur:m=$}=e,f=g("input",`text-${s}`,{"focus:shadow-none":a},t);return l.exports.createElement("input",{disabled:u,className:f,style:n,value:r,autoFocus:c,type:i,onChange:h=>p(h.target.value,h),onBlur:m})}function Ge(e){const{show:t=!0,title:n="Modal",size:r="small",footer:s=!0,onOk:a=$,onClose:c=$,bodyClassName:i,bodyStyle:u,className:p,style:m,children:f}=e,{translation:h}=S(),{t:N}=h("Modal"),v=l.exports.useRef(document.createElement("div")),L=l.exports.useRef(null);l.exports.useLayoutEffect(()=>{const D=v.current;return document.body.appendChild(D),()=>{document.body.removeChild(D)}},[]);function I(D){D.target===L.current&&c()}const U=o.createElement("div",{className:g("modal-mask",{"modal-show":t}),ref:L,onMouseDown:I},o.createElement("div",{className:g("modal",`modal-${r}`,p),style:m},o.createElement("div",{className:"modal-title"},n),o.createElement("div",{className:g("modal-body",i),style:u},f),s&&o.createElement("div",{className:"footer"},o.createElement(je,{onClick:()=>c()},N("cancel")),o.createElement(je,{type:"primary",onClick:()=>a()},N("ok")))));return Se.exports.createPortal(U,v.current)}const Jt={success:"check",info:"info",warning:"info",error:"close"};function Xt(e){const{message:t="",type:n="info",inside:r=!1,children:s,className:a,style:c}=e,i=g("alert",`alert-${r?"note":"box"}-${n}`,a);return o.createElement("div",{className:i,style:c},o.createElement("span",{className:"alert-icon"},o.createElement(B,{type:Jt[n],size:26})),t?o.createElement("p",{className:"alert-message"},t):o.createElement("div",{className:"alert-message"},s))}function je(e){const{type:t="normal",onClick:n=$,children:r,className:s,style:a}=e,c=g("button",`button-${t}`,s);return l.exports.createElement("button",{className:c,style:a,onClick:n},r)}function Ve(e){const{className:t,checked:n=!1,onChange:r=$}=e,s=g("checkbox",{checked:n},t);function a(){r(!n)}return l.exports.createElement("div",{className:s,onClick:a},l.exports.createElement(B,{className:"checkbox-icon",type:"check",size:18}),l.exports.createElement("div",null,e.children))}function ne(e){const{color:t,className:n,style:r}=e,s=g("tag",n),a=C({color:t},r),c=k(C({},e),{className:s,style:a});return l.exports.createElement("span",C({},c),e.children)}function Yt(e){const t=g("spinner",e.className);return l.exports.createElement("div",{className:t},l.exports.createElement("div",{className:"spinner-circle"},l.exports.createElement("div",{className:"spinner-inner"})),l.exports.createElement("div",{className:"spinner-circle"},l.exports.createElement("div",{className:"spinner-inner"})),l.exports.createElement("div",{className:"spinner-circle"},l.exports.createElement("div",{className:"spinner-inner"})),l.exports.createElement("div",{className:"spinner-circle"},l.exports.createElement("div",{className:"spinner-inner"})),l.exports.createElement("div",{className:"spinner-circle"},l.exports.createElement("div",{className:"spinner-inner"})))}function Kt(e){const t=g("loading","visible",e.className);return e.visible?o.createElement("div",{className:t},o.createElement(Yt,{className:e.spinnerClassName})):null}const Je={"#909399":0,"#00c520":260,"#ff9a28":600,"#ff3e5e":Infinity};async function Qt(e){var n;if(_())return(n=await(b==null?void 0:b.getProxyDelay(e)))!=null?n:0;const{data:{delay:t}}=await It(e);return t}function Xe(e){const{config:t,className:n}=e,{set:r}=te(),s=l.exports.useCallback(async function(){const p=await O.fromPromise(Qt(t.name),f=>f),m=p.isErr()?0:p.value;r(f=>{const h=f.proxies.find(N=>N.name===t.name);h&&h.history.push({time:Date.now().toString(),delay:m})})},[t.name,r]),a=l.exports.useMemo(()=>{var p;return((p=t.history)==null?void 0:p.length)?t.history.slice(-1)[0].delay:0},[t]);l.exports.useLayoutEffect(()=>(ue.subscribe(X.SPEED_NOTIFY,s),()=>ue.unsubscribe(X.SPEED_NOTIFY,s)),[s]);const c=l.exports.useMemo(()=>a===0,[a]),i=l.exports.useMemo(()=>Object.keys(Je).find(p=>a<=Je[p]),[a]),u=c?void 0:i;return o.createElement("div",{className:g("proxy-item",{"proxy-error":c},n)},o.createElement("span",{className:"proxy-type",style:{backgroundColor:u}},t.type),o.createElement("p",{className:"proxy-name"},t.name),o.createElement("p",{className:"proxy-delay"},a===0?"-":`${a}ms`))}function Zt(e){const{markProxySelected:t}=te(),[n]=A(zt),{data:r}=Me(),{config:s}=e;async function a(u){if(await Mt(e.config.name,u),t(e.config.name,u),r.breakConnections){const p=[],m=await Ht();for(const f of m.data.connections)f.chains.includes(e.config.name)&&p.push(f.id);for(const f of p)$t(f)}}const c=l.exports.useMemo(()=>{var p;const u=new Set;for(const m of s.all){const f=(p=n.get(m))==null?void 0:p.history;(f==null?void 0:f.length)&&f.slice(-1)[0].delay===0&&u.add(m)}return u},[s.all,n]),i=s.type==="Selector";return o.createElement("div",{className:"proxy-group"},o.createElement("div",{className:"proxy-group-part"},o.createElement("span",{className:"proxy-group-name"},s.name),o.createElement(ne,{className:"proxy-group-type"},s.type)),o.createElement("div",{className:"proxy-group-tags-container"},o.createElement(Vt,{className:"proxy-group-tags",data:s.all,onClick:a,errSet:c,select:s.now,canClick:i,rowHeight:30})))}ie.extend(lt);function ge(e,t){const n=t==="en_US"?"en":"zh-cn";return ie().locale(n).from(e)}function en(e){const{update:t}=Oe(),{translation:n,lang:r}=S(),{provider:s}=e,{t:a}=n("Proxies"),{visible:c,hide:i,show:u}=de();function p(){u(),Tt(s.name).then(()=>t()).finally(()=>i())}function m(){u(),At(s.name).then(()=>t()).finally(()=>i())}const f=l.exports.useMemo(()=>s.proxies.slice().sort((h,N)=>-1*ye(h,N)),[s.proxies]);return l.exports.createElement(M,{className:"proxy-provider"},l.exports.createElement(Kt,{visible:c}),l.exports.createElement("div",{className:"proxy-provider-header"},l.exports.createElement("div",{className:"proxy-provider-header-part"},l.exports.createElement("span",{className:"proxy-provider-name"},s.name),l.exports.createElement(ne,null,s.vehicleType)),l.exports.createElement("div",{className:"proxy-provider-header-part"},s.updatedAt&&l.exports.createElement("span",{className:"proxy-provider-update"},`${a("providerUpdateTime")}: ${ge(new Date(s.updatedAt),r)}`),l.exports.createElement(B,{className:"proxy-provider-icon healthcheck",type:"healthcheck",size:18,onClick:p}),l.exports.createElement(B,{className:"proxy-provider-icon",type:"update",size:18,onClick:m}))),l.exports.createElement("ul",{className:"proxies-list"},f.map(h=>l.exports.createElement("li",{key:h.name},l.exports.createElement(Xe,{className:"proxy-provider-item",config:h})))))}var Ye;(function(e){e[e.None=0]="None",e[e.Asc=1]="Asc",e[e.Desc=2]="Desc"})(Ye||(Ye={}));const tn={[0]:"sort",[1]:"sort-ascending",[2]:"sort-descending"};function ye(e,t){const n=e.history.length?e.history.slice(-1)[0].delay:0;return((t.history.length?t.history.slice(-1)[0].delay:0)||Number.MAX_SAFE_INTEGER)-(n||Number.MAX_SAFE_INTEGER)}function nn(){const{groups:e,global:t}=te(),{data:n,set:r}=Me(),{general:s}=qe(),{translation:a}=S(),{t:c}=a("Proxies"),i=l.exports.useMemo(()=>s.mode==="global"?[t]:e,[s,e,t]);return o.createElement(o.Fragment,null,i.length!==0&&o.createElement("div",{className:"flex flex-col"},o.createElement(H,{title:c("groupTitle")},o.createElement(Ve,{className:"text-primary-600 text-sm text-shadow-primary cursor-pointer",checked:n.breakConnections,onChange:u=>r("breakConnections",u)},c("breakConnectionsText"))),o.createElement(M,{className:"my-2.5 md:my-4 p-0"},o.createElement("ul",{className:"list-none"},i.map(u=>o.createElement("li",{className:"proxies-group-item",key:u.name},o.createElement(Zt,{config:u})))))))}function sn(){const{providers:e}=Oe(),{translation:t}=S(),{t:n}=t("Proxies");return o.createElement(o.Fragment,null,e.length!==0&&o.createElement("div",{className:"flex flex-col"},o.createElement(H,{title:n("providerTitle")}),o.createElement("ul",{className:"list-none"},e.map(r=>o.createElement("li",{className:"my-2.5 md:my-4",key:r.name},o.createElement(en,{provider:r}))))))}function on(){const{proxies:e}=te(),{translation:t}=S(),{t:n}=t("Proxies");function r(){ue.notifySpeedTest()}const{current:s,next:a}=wt([1,2,0]),c=l.exports.useMemo(()=>{switch(s){case 2:return e.slice().sort((u,p)=>ye(u,p));case 1:return e.slice().sort((u,p)=>-1*ye(u,p));default:return e.slice()}},[s,e]),i=a;return o.createElement(o.Fragment,null,c.length!==0&&o.createElement("div",{className:"flex flex-col"},o.createElement(H,{title:n("title")},o.createElement(B,{className:"ml-3",type:tn[s],onClick:i,size:20}),o.createElement(B,{className:"ml-3",type:"speed",size:20}),o.createElement("span",{className:"proxies-speed-test",onClick:r},n("speedTestText"))),o.createElement("ul",{className:"proxies-list"},c.map(u=>o.createElement("li",{key:u.name},o.createElement(Xe,{config:u}))))))}function rn(){return o.createElement("div",{className:"page"},o.createElement(nn,null),o.createElement(sn,null),o.createElement(on,null))}function an(){const e=l.exports.useRef(null),t=l.exports.useRef([]),[n,r]=l.exports.useState([]),{translation:s}=S(),{t:a}=s("Logs");return l.exports.useLayoutEffect(()=>{const c=e.current;c&&(c.scrollTop=c.scrollHeight)}),l.exports.useEffect(()=>{let c=null;function i(u){t.current=t.current.slice().concat(u.map(p=>k(C({},p),{time:new Date}))),r(t.current)}return async function(){c=await Ie(),t.current=c.buffer(),r(t.current),c.subscribe("data",i)}(),()=>c==null?void 0:c.unsubscribe("data",i)},[]),o.createElement("div",{className:"page"},o.createElement(H,{title:a("title")}),o.createElement(M,{className:"flex flex-col flex-1 mt-2.5 md:mt-4"},o.createElement("ul",{className:"logs-panel",ref:e},n.map((c,i)=>o.createElement("li",{className:"leading-5 inline-block",key:i},o.createElement("span",{className:"mr-4 text-gray-400 text-opacity-90"},ie(c.time).format("YYYY-MM-DD HH:mm:ss")),o.createElement("span",null,"[",c.type,"] ",c.payload))))))}function ln(e){const{update:t}=He(),{translation:n,lang:r}=S(),{provider:s}=e,{t:a}=n("Rules"),{visible:c,hide:i,show:u}=de();function p(){u(),Lt(s.name).then(()=>t()).finally(()=>i())}const m=g("rule-provider-icon",{"rule-provider-loading":c});return l.exports.createElement(M,{className:"rule-provider"},l.exports.createElement("div",{className:"rule-provider-header"},l.exports.createElement("div",{className:"rule-provider-header-part"},l.exports.createElement("span",{className:"rule-provider-name"},s.name),l.exports.createElement(ne,null,s.vehicleType),l.exports.createElement(ne,{className:"rule-provider-behavior"},s.behavior),l.exports.createElement("span",{className:"rule-provider-update"},`${a("ruleCount")}: ${s.ruleCount}`)),l.exports.createElement("div",{className:"rule-provider-header-part"},s.updatedAt&&l.exports.createElement("span",{className:"rule-provider-update"},`${a("providerUpdateTime")}: ${ge(new Date(s.updatedAt),r)}`),l.exports.createElement(B,{className:m,type:"update",size:18,onClick:p}))))}function cn(){const{providers:e}=He(),{translation:t}=S(),{t:n}=t("Rules");return o.createElement(o.Fragment,null,e.length!==0&&o.createElement("div",{className:"flex flex-col"},o.createElement(H,{title:n("providerTitle")}),o.createElement("ul",{className:"proxies-providers-list"},e.map(r=>o.createElement("li",{className:"proxies-providers-item",key:r.name},o.createElement(ln,{provider:r}))))))}function un(){const{rules:e,update:t}=jt(),{translation:n}=S(),{t:r}=n("Rules");q("rules",t);function s({index:a,style:c}){const i=e[a];return o.createElement("li",{className:"rule-item",style:c},o.createElement("div",{className:"py-1 flex"},o.createElement("div",{className:"rule-type w-40 text-center"},i.type),o.createElement("div",{className:"payload flex-1 text-center"},i.payload),o.createElement("div",{className:"rule-proxy w-40 text-center"},i.proxy)))}return o.createElement("div",{className:"page"},o.createElement(cn,null),o.createElement(H,{title:r("title")}),o.createElement(M,{className:"flex flex-col flex-1 mt-2.5 md:mt-4 p-0 focus:outline-none"},o.createElement(ct,{className:"rules"},({height:a,width:c})=>o.createElement(it,{height:a,width:c,itemCount:e.length,itemSize:50},s))))}const mn=[{label:"\u4E2D\u6587",value:"zh_CN"},{label:"English",value:"en_US"}];function dn(){var d,y,w;const{premium:e}=$e(),{data:t,update:n}=ze(),{general:r,update:s}=qe(),{set:a}=Ee(),{data:c}=_e(),{translation:i,setLang:u,lang:p}=S(),{t:m}=i("Settings"),[f,h]=me({socks5ProxyPort:7891,httpProxyPort:7890,mixedProxyPort:0});l.exports.useEffect(()=>{var E,we,Ce;h("socks5ProxyPort",(E=r==null?void 0:r.socksPort)!=null?E:0),h("httpProxyPort",(we=r==null?void 0:r.port)!=null?we:0),h("mixedProxyPort",(Ce=r==null?void 0:r.mixedPort)!=null?Ce:0)},[r,h]);async function N(E){await Y({mode:E}),await s()}async function v(E){await(b==null?void 0:b.setStartAtLogin(E)),n()}async function L(E){await(b==null?void 0:b.setSystemProxy(E)),n()}function I(E){u(E)}async function U(){await Y({port:f.httpProxyPort}),await s()}async function D(){await Y({"socks-port":f.socks5ProxyPort}),await s()}async function F(){await Y({"mixed-port":f.mixedProxyPort}),await s()}async function T(E){await Y({"allow-lan":E}),await s()}const{hostname:se,port:oe}=c,{allowLan:j,mode:V}=r,re=(d=t==null?void 0:t.startAtLogin)!=null?d:!1,ae=(y=t==null?void 0:t.systemProxy)!=null?y:!1,R=(w=t==null?void 0:t.isClashX)!=null?w:!1,le=l.exports.useMemo(()=>{const E=[{label:m("values.global"),value:"Global"},{label:m("values.rules"),value:"Rule"},{label:m("values.direct"),value:"Direct"}];return e&&E.push({label:m("values.script"),value:"Script"}),E},[m,e]);return o.createElement("div",{className:"page"},o.createElement(H,{title:m("title")}),o.createElement(M,{className:"settings-card"},o.createElement("div",{className:"flex flex-wrap"},o.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},o.createElement("span",{className:"label font-bold"},m("labels.startAtLogin")),o.createElement(pe,{disabled:!(t==null?void 0:t.isClashX),checked:re,onChange:v})),o.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},o.createElement("span",{className:"label font-bold"},m("labels.language")),o.createElement(Fe,{options:mn,value:p,onSelect:E=>I(E)}))),o.createElement("div",{className:"flex flex-wrap"},o.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},o.createElement("span",{className:"label font-bold"},m("labels.setAsSystemProxy")),o.createElement(pe,{disabled:!R,checked:ae,onChange:L})),o.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},o.createElement("span",{className:"label font-bold"},m("labels.allowConnectFromLan")),o.createElement(pe,{checked:j,onChange:T})))),o.createElement(M,{className:"settings-card"},o.createElement("div",{className:"flex flex-wrap"},o.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},o.createElement("span",{className:"label font-bold"},m("labels.proxyMode")),o.createElement(Fe,{options:le,value:ut(V),onSelect:N})),o.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},o.createElement("span",{className:"label font-bold"},m("labels.socks5ProxyPort")),o.createElement(G,{className:"w-28",disabled:R,value:f.socks5ProxyPort,onChange:E=>h("socks5ProxyPort",+E),onBlur:D}))),o.createElement("div",{className:"flex flex-wrap"},o.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},o.createElement("span",{className:"label font-bold"},m("labels.httpProxyPort")),o.createElement(G,{className:"w-28",disabled:R,value:f.httpProxyPort,onChange:E=>h("httpProxyPort",+E),onBlur:U})),o.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},o.createElement("span",{className:"label font-bold"},m("labels.mixedProxyPort")),o.createElement(G,{className:"w-28",disabled:R,value:f.mixedProxyPort,onChange:E=>h("mixedProxyPort",+E),onBlur:F}))),o.createElement("div",{className:"flex flex-wrap"},o.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},o.createElement("span",{className:"label font-bold"},m("labels.externalController")),o.createElement("span",{className:g({"modify-btn":!R},"external-controller"),onClick:()=>!R&&a(!1)},`${se}:${oe}`)),o.createElement("div",{className:"w-1/2 px-8"}))))}var pn="./assets/logo.b453e72f.png";function fn(e){const{routes:t}=e,{translation:n}=S(),{version:r,premium:s,update:a}=$e(),{data:c}=ze(),{t:i}=n("SideBar");q("version",a);const u=t.map(({path:p,name:m,exact:f,noMobile:h})=>l.exports.createElement("li",{className:g("item",{"no-mobile":h}),key:m},l.exports.createElement(mt,{to:p,activeClassName:"active",exact:!!f},i(m))));return l.exports.createElement("div",{className:"sidebar"},l.exports.createElement("img",{src:pn,alt:"logo",className:"sidebar-logo"}),l.exports.createElement("ul",{className:"sidebar-menu"},u),l.exports.createElement("div",{className:"sidebar-version"},l.exports.createElement("span",{className:"sidebar-version-label"},"Clash",(c==null?void 0:c.isClashX)&&"X"," ",i("Version")),l.exports.createElement("span",{className:"sidebar-version-text"},r),s&&l.exports.createElement("span",{className:"sidebar-version-label"},"Premium")))}var ve;(function(e){e.Domain="Domain",e.DomainSuffix="DomainSuffix",e.DomainKeyword="DomainKeyword",e.GeoIP="GeoIP",e.IPCIDR="IPCIDR",e.SrcIPCIDR="SrcIPCIDR",e.SrcPort="SrcPort",e.DstPort="DstPort",e.MATCH="MATCH",e.RuleSet="RuleSet"})(ve||(ve={}));function hn(e){const{translation:t}=S(),n=l.exports.useMemo(()=>t("Connections").t,[t]),{className:r,style:s}=e,a=g("connections-devices",r);function c(i){var u;(u=e.onChange)==null||u.call(e,i)}return o.createElement("div",{className:a,style:s},o.createElement("div",{className:g("connections-devices-item",{selected:e.selected===""}),onClick:()=>c("")},n("filter.all")),e.devices.map(i=>o.createElement("div",{key:i.label,className:g("connections-devices-item",{selected:e.selected===i.label}),onClick:()=>c(i.label)},i.label," (",i.number,")")))}class xn{constructor(){this.connections=new Map,this.saveDisconnection=!1}appendToSet(t){var r;const n=t.reduce((s,a)=>s.set(a.id,a),new Map);for(const s of this.connections.keys())if(!n.has(s))if(!this.saveDisconnection)this.connections.delete(s);else{const a=this.connections.get(s);a&&(a.completed=!0,a.uploadSpeed=0,a.downloadSpeed=0)}for(const s of n.keys()){if(!this.connections.has(s)){this.connections.set(s,k(C({},n.get(s)),{uploadSpeed:0,downloadSpeed:0}));continue}const a=this.connections.get(s),c=n.get(s);(r=this.connections)==null||r.set(s,k(C({},c),{uploadSpeed:c.upload-a.upload,downloadSpeed:c.download-a.download}))}}toggleSave(){var t,n;if(this.saveDisconnection){this.saveDisconnection=!1;for(const r of this.connections.keys())((n=(t=this.connections)==null?void 0:t.get(r))==null?void 0:n.completed)&&this.connections.delete(r)}else this.saveDisconnection=!0;return this.saveDisconnection}getConnections(){return[...this.connections.values()]}}function En(){const e=l.exports.useMemo(()=>new xn,[]),t=l.exports.useRef(!0),[n,r]=l.exports.useState([]),[s,a]=l.exports.useState(!1),c=l.exports.useCallback(function(u){e.appendToSet(u),t.current&&r(e.getConnections()),t.current=!t.current},[e]),i=l.exports.useCallback(function(){const u=e.toggleSave();a(u),u||r(e.getConnections()),t.current=!0},[e]);return{connections:n,feed:c,toggleSave:i,save:s}}var x;(function(e){e.Host="host",e.Network="network",e.Type="type",e.Chains="chains",e.Rule="rule",e.Speed="speed",e.Upload="upload",e.Download="download",e.SourceIP="sourceIP",e.Time="time"})(x||(x={}));const gn=new Set([x.Network,x.Type,x.Rule,x.Speed,x.Upload,x.Download,x.SourceIP,x.Time]);function W(e){const t=["B","KB","MB","GB","TB"];let n=0;for(;~~(e/1024)&&n<t.length;)e/=1024,n++;return`${n===0?e:e.toFixed(2)} ${t[n]}`}function yn(e,t){switch(!0){case(e===0&&t===0):return"-";case(e!==0&&t!==0):return`\u2191 ${W(e)}/s \u2193 ${W(t)}/s`;case e!==0:return`\u2191 ${W(e)}/s`;default:return`\u2193 ${W(t)}/s`}}function vn(){const{translation:e,lang:t}=S(),n=l.exports.useMemo(()=>e("Connections").t,[e]),[r,s]=me({uploadTotal:0,downloadTotal:0}),{visible:a,show:c,hide:i}=de();function u(){Rt().finally(()=>i())}const{connections:p,feed:m,save:f,toggleSave:h}=En(),N=l.exports.useMemo(()=>p.map(d=>({id:d.id,host:`${d.metadata.host||d.metadata.destinationIP}:${d.metadata.destinationPort}`,chains:d.chains.slice().reverse().join(" / "),rule:d.rule===ve.RuleSet?`${d.rule}(${d.rulePayload})`:d.rule,time:new Date(d.start).getTime(),upload:d.upload,download:d.download,sourceIP:d.metadata.sourceIP,type:d.metadata.type,network:d.metadata.network.toUpperCase(),speed:{upload:d.uploadSpeed,download:d.downloadSpeed},completed:!!d.completed})),[p]),v=l.exports.useMemo(()=>{const d=dt(p,"metadata.sourceIP");return Object.keys(d).map(y=>({label:y,number:d[y].length})).sort((y,w)=>y.label.localeCompare(w.label))},[p]),L=l.exports.useRef(null),{x:I}=pt(L),U=l.exports.useMemo(()=>[{Header:n(`columns.${x.Host}`),accessor:x.Host,minWidth:260,width:260},{Header:n(`columns.${x.Network}`),accessor:x.Network,minWidth:80,width:80},{Header:n(`columns.${x.Type}`),accessor:x.Type,minWidth:120,width:120},{Header:n(`columns.${x.Chains}`),accessor:x.Chains,minWidth:200,width:200},{Header:n(`columns.${x.Rule}`),accessor:x.Rule,minWidth:140,width:140},{id:x.Speed,Header:n(`columns.${x.Speed}`),accessor(d){return[d.speed.upload,d.speed.download]},sortType(d,y){const w=d.original.speed,E=y.original.speed;return w.download===E.download?w.upload-E.upload:w.download-E.download},minWidth:200,width:200,sortDescFirst:!0},{Header:n(`columns.${x.Upload}`),accessor:x.Upload,minWidth:100,width:100,sortDescFirst:!0},{Header:n(`columns.${x.Download}`),accessor:x.Download,minWidth:100,width:100,sortDescFirst:!0},{Header:n(`columns.${x.SourceIP}`),accessor:x.SourceIP,minWidth:140,width:140},{Header:n(`columns.${x.Time}`),accessor:x.Time,minWidth:120,width:120,sortType(d,y){return y.original.time-d.original.time}}],[n]);l.exports.useLayoutEffect(()=>{let d=null;function y(w){for(const E of w)s({uploadTotal:E.uploadTotal,downloadTotal:E.downloadTotal}),m(E.connections)}return async function(){d=await Ut(),d.subscribe("data",y)}(),()=>{d&&(d.unsubscribe("data",y),d.destory())}},[m,s]);const{getTableProps:D,getTableBodyProps:F,headerGroups:T,rows:se,prepareRow:oe,setFilter:j}=J.exports.useTable({columns:U,data:N,autoResetSortBy:!1,autoResetFilters:!1,initialState:{sortBy:[{id:x.Time,desc:!1}]}},J.exports.useResizeColumns,J.exports.useBlockLayout,J.exports.useFilters,J.exports.useSortBy),V=l.exports.useMemo(()=>T[0],[T]),re=l.exports.useCallback(function(d){switch(d.column.id){case x.Speed:return yn(d.value[0],d.value[1]);case x.Upload:case x.Download:return W(d.value);case x.Time:return ge(new Date(d.value),t);default:return d.value}},[t]),[ae,R]=l.exports.useState("");function le(d){R(d),j==null||j(x.SourceIP,d)}return o.createElement("div",{className:"page"},o.createElement(H,{title:n("title")},o.createElement("span",{className:"connections-filter flex-1 cursor-default"},`(${n("total.text")}: ${n("total.upload")} ${W(r.uploadTotal)} ${n("total.download")} ${W(r.downloadTotal)})`),o.createElement(Ve,{className:"connections-filter",checked:f,onChange:h},n("keepClosed")),o.createElement(B,{className:"connections-filter dangerous",onClick:c,type:"close-all",size:20})),v.length>1&&o.createElement(hn,{devices:v,selected:ae,onChange:le}),o.createElement(M,{className:"connections-card"},o.createElement("div",k(C({},D()),{className:"flex flex-col w-full flex-1 overflow-auto",style:{flexBasis:0},ref:L}),o.createElement("div",k(C({},V.getHeaderGroupProps()),{className:"connections-header"}),V.headers.map((d,y)=>{const w=d,E=w.id;return o.createElement("div",k(C({},w.getHeaderProps()),{className:g("connections-th",{resizing:w.isResizing,fixed:I>0&&w.id===x.Host}),key:E}),o.createElement("div",C({},w.getSortByToggleProps()),d.render("Header"),w.isSorted?w.isSortedDesc?" \u2193":" \u2191":null),y!==V.headers.length-1&&o.createElement("div",k(C({},w.getResizerProps()),{className:"connections-resizer"})))})),o.createElement("div",k(C({},F()),{className:"flex-1"}),se.map(d=>(oe(d),o.createElement("div",k(C({},d.getRowProps()),{className:"connections-item",key:d.original.id}),d.cells.map(y=>{const w=g("connections-block",{"text-center":gn.has(y.column.id),completed:d.original.completed},{fixed:I>0&&y.column.id===x.Host});return o.createElement("div",k(C({},y.getCellProps()),{className:w,key:y.column.id}),re(y))}))))))),o.createElement(Ge,{title:n("closeAll.title"),show:a,onClose:i,onOk:u},n("closeAll.content")))}function wn(){const{translation:e}=S(),{t}=e("Settings"),{data:n,update:r,fetch:s}=_e(),{identity:a,set:c}=Ee(),[i,u]=me({hostname:"",port:"",secret:""});l.exports.useEffect(()=>{s()},[s]),l.exports.useEffect(()=>{u({hostname:n.hostname,port:n.port,secret:n.secret})},[n,u]);function p(){const{hostname:m,port:f,secret:h}=i;r({hostname:m,port:f,secret:h})}return o.createElement(Ge,{show:!a,title:t("externalControllerSetting.title"),bodyClassName:"external-controller",onClose:()=>c(!0),onOk:p},o.createElement(Xt,{type:"info",inside:!0},o.createElement("p",null,t("externalControllerSetting.note"))),o.createElement("div",{className:"flex items-center"},o.createElement("span",{className:"md:my-3 w-14 my-1 font-bold"},t("externalControllerSetting.host")),o.createElement(G,{className:"md:my-3 flex-1 my-1",align:"left",inside:!0,value:i.hostname,onChange:m=>u("hostname",m)})),o.createElement("div",{className:"flex items-center"},o.createElement("div",{className:"md:my-3 w-14 my-1 font-bold"},t("externalControllerSetting.port")),o.createElement(G,{className:"md:my-3 w-14 my-1 flex-1",align:"left",inside:!0,value:i.port,onChange:m=>u("port",m)})),o.createElement("div",{className:"flex items-center"},o.createElement("div",{className:"md:my-3 w-14 my-1 font-bold"},t("externalControllerSetting.secret")),o.createElement(G,{className:"md:my-3 w-14 my-1 flex-1",align:"left",inside:!0,value:i.secret,onChange:m=>u("secret",m)})))}function Cn(){l.exports.useEffect(()=>{Ie()},[]);const e=[{path:"/proxies",name:"Proxies",component:rn},{path:"/logs",name:"Logs",component:an},{path:"/rules",name:"Rules",component:un,noMobile:!0},{path:"/connections",name:"Connections",component:vn,noMobile:!0},{path:"/settings",name:"Settings",component:dn}];return o.createElement("div",{className:g("app",{"not-clashx":!_()})},o.createElement(fn,{routes:e}),o.createElement("div",{className:"page-container"},o.createElement(ft,null,o.createElement(ke,{exact:!0,path:"/",component:()=>o.createElement(ht,{to:"/proxies"})}),e.map(t=>o.createElement(ke,{exact:!1,path:t.path,key:t.path,component:t.component})))),o.createElement(wn,null))}function Ke(){const e=document.getElementById("root"),t=o.createElement(xt,null,o.createElement(Cn,null));Se.exports.render(t,e)}_()?gt(()=>Ke()):Ke();
